import pandas as pd
import matplotlib.pyplot as plt
from collections import defaultdict

# Load the CSV file
file_path = 'Output/Summary.csv'
data = pd.read_csv(file_path)

# Mapping dictionary for callsign prefixes to airline names
callsign_to_airline_full = defaultdict(lambda: 'Unknown')
callsign_to_airline_full.update({
    'AAL': 'American Airlines',
    'ACA': 'Air Canada',
    'AFR': 'Air France',
    'AIC': 'Air India',
    'ANA': 'All Nippon Airways',
    'BAW': 'British Airways',
    'CPA': 'Cathay Pacific',
    'DAL': 'Delta Air Lines',
    'DLH': 'Lufthansa',
    'EZY': 'EasyJet',
    'QTR': 'Qatar Airways',
    'SIA': 'Singapore Airlines',
    'UAL': 'United Airlines',
    'UAE': 'Emirates',
    'AAR': 'Asiana Airlines',
    'AZA': 'Alitalia',
    'CSN': 'China Southern Airlines',
    'JAL': 'Japan Airlines',
    'KAL': 'Korean Air',
    'KLM': 'KLM Royal Dutch Airlines',
    'QFA': 'Qantas',
    'SWR': 'Swiss International Air Lines',
    'THA': 'Thai Airways',
    'TAP': 'TAP Air Portugal',
    'SAS': 'Scandinavian Airlines',
    'SIA': 'Singapore Airlines',
    'VIR': 'Virgin Atlantic',
    'IBE': 'Iberia',
    'AVA': 'Avianca',
    'CES': 'China Eastern Airlines',
    'CLX': 'Cargolux',
    'ETD': 'Etihad Airways',
    'ETH': 'Ethiopian Airlines',
    'FIN': 'Finnair',
    'GIA': 'Garuda Indonesia',
    'HAL': 'Hawaiian Airlines',
    'JBU': 'JetBlue Airways',
    'KAC': 'Kuwait Airways',
    'MAS': 'Malaysia Airlines',
    'NAX': 'Norwegian Air Shuttle',
    'PAL': 'Philippine Airlines',
    'REU': 'REUNION AIRWAYS',
    'RYR': 'Ryanair',
    'TOM': 'Thomson Airways',
    'TSC': 'Air Transat',
    'VJC': 'VietJet Air',
    'VOI': 'Volaris',
    'WJA': 'WestJet',
    'WZZ': 'Wizz Air',
    'ALC': 'Alaska Airlines',
    'ANZ': 'Air New Zealand',
    'AUA': 'Austrian Airlines',
    'AXM': 'AirAsia',
    'BEL': 'Brussels Airlines',
    'BER': 'Air Berlin',
    'BHA': 'Biman Bangladesh Airlines',
    'CCA': 'Air China',
    'CHH': 'Hainan Airlines',
    'COA': 'Continental Airlines',
    'CPA': 'Cathay Pacific',
    'CYP': 'Cyprus Airways',
    'DAH': 'Air Algérie',
    'DLH': 'Lufthansa',
    'ELY': 'El Al',
    'GWI': 'Germanwings',
    'ICE': 'Icelandair',
    'IRA': 'Iran Air',
    'IRA': 'Iraqi Airways',
    'ISL': 'Israir Airlines',
    'IZM': 'Izmir Airlines',
    'JAI': 'Jet Airways',
    'KQA': 'Kenya Airways',
    'LNI': 'Lion Air',
    'LOT': 'LOT Polish Airlines',
    'LTU': 'LTU International',
    'MAU': 'Air Mauritius',
    'MEP': 'Merpati Nusantara Airlines',
    'MON': 'Monarch Airlines',
    'MSR': 'EgyptAir',
    'NWB': 'Nordwind Airlines',
    'OAL': 'Olympic Air',
    'OLT': 'OLT Express',
    'PIA': 'Pakistan International Airlines',
    'RAM': 'Royal Air Maroc',
    'RAR': 'Rarotonga Air',
    'ROT': 'Tarom',
    'RPA': 'Republic Airlines',
    'SAA': 'South African Airways',
    'SAS': 'Scandinavian Airlines',
    'SBI': 'S7 Airlines',
    'SLK': 'SilkAir',
    'SWG': 'Sunwing Airlines',
    'THY': 'Turkish Airlines',
    'TIC': 'Tigerair',
    'TLM': 'Transaero',
    'TRS': 'TriStar Air',
    'UAE': 'Emirates',
    'UPA': 'Ukrainian Cargo Airways',
    'VLG': 'Vueling Airlines',
    'WAW': 'WOW air',
    'XAX': 'AirAsia X',
    'YMA': 'Yemenia',
    'ZXP': 'Air Zimbabwe',
    'SKU': 'SKY Airline',
    'CSC': 'Sichuan Airlines',
    'FFT': 'Frontier Airlines',
    'SDM': 'Rossiya Airlines',
    'LWA': 'Libyan Wings',
    'SHT': 'British Airways',
    'MMA': 'Myanmar Airways International',
    'CBJ': 'Beijing Capital Airlines',
    'GLG': 'Avianca Ecuador S.A.',
    'LPE': 'LATAM Airlines Perú',
    'SKU': 'SKY Airline',
    'EWG': 'Eurowings',
    'NKS': 'Spirit Airlines',
    'CEB': 'Cebu Pacific',
    'CHB': 'West Air',
    'UZB': 'Uzbekistan Airways',
    'JST': 'Jetstar Airways',
    'SVA': 'Saudia',
    'BTK': 'Batik Air',
    'TGG': 'Tigerair Australia',
    'PGT': 'Pegasus Airlines',
    'CDC': 'Loong Air',
    'SVR': 'Ural Airlines',
    'LXP': 'LATAM Airlines',
    'ONE': 'One Airlines',
    'VIV': 'Viva Air',
    'CSZ': 'Shenzhen Airlines',
    'AFL': 'Aeroflot – Russian Airlines',
    'AEE': 'Aegean Airlines',
    'DKH': 'Juneyao Airlines',
    'ABY': 'Air Arabia',
    'IGO': 'IndiGo',
    'HDA': 'Cathay Dragon',
    'ASA': 'Alaska Airlines',
    'AWQ': 'Indonesia AirAsia',
    'TVJ': 'Thai VietJet Air',
    'AIJ': 'Interjet',
    'LAO': 'Lao Airlines',
    'AAY': 'Allegiant Air',
    'PGT': 'Pegasus Airlines',
    'TAR': 'TAR Aerolíneas',
    'CBJ': 'Beijing Capital Airlines',
    'SHT': 'British Airways',
    'MMA': 'Myanmar Airways International',
    'GLG': 'Avianca Ecuador',
    'TGW': 'Scoot',
    'BKP': 'Bangkok Airways',
    'CTN': 'Croatia Airlines',
    'ROU': 'Air Canada Rouge',
    'TBA': 'Tibet Airlines',
    'HKE': 'HK Express',
    'ASV': 'Air Seoul',
    'IBS': 'Iberia Express',
    'ABL': 'AIR BUSAN',
    'AMU': 'Air Macau',
    'TAM': 'LATAM Airlines Brasil',
    'HVN': 'Vietnam Airlines',
    'LRC': 'Avianca Costa Rica',
    'EIN': 'Aer Lingus',
    'TCX': 'Thomas Cook Airlines',
    'VTI': 'Vistara',
    'VKG': 'Sunclass Airlines',
    'GOW': 'Go First',
    'LKE': 'Lucky Air',
    'AIQ': 'Thai AirAsia',
    'CTV': 'Citilink',
    'CBG': 'GX Airlines',
    'TAY': 'ASL Airlines Belgium',
    'UTA': 'UTair Aviation',
    'AJK': 'Allied Air',
    'BCS': 'European Air Transport',
    'KMI': 'K-Mile Asia',
    'FPO': 'ASL Airlines France',
    'BPA': 'Blue Panorama Airlines',
    'AZU': 'Azul Brazilian Airlines',
    'CQN': 'Chongqing Airlines',
    'KZR': 'Air Astana',
    'FLE': 'Flair Airlines',
    'AWT': 'Albawings',
    'BBD': 'Bluebird Nordic',
    'APK': 'Air Peace',
    'NPT': 'West Atlantic UK',
    'MSA': 'Malaysia–Singapore Airlines',
    'CGF': 'Cargoair',
    'BMS': 'Blue Air Aviation',
    'SWQ': 'iAero Airways',
    'AFG': 'Ariana Afghan Airlines',
    'MLD': 'Air Moldova',
    'SOO': 'Southern Air',
    'SWA': 'Southwest Airlines',
    'ARG': 'Aerolineas Argentinas',
    'JAF': 'TUI fly Belgium',
    'SKW': 'SkyWest Airlines',
    'ENY': 'Envoy Air',
    'QXE': 'Horizon Air',
    'FDA': 'Fuji Dream Airlines',
    'ASH': 'Mesa Airlines',
    'CPZ': 'Compass Airlines',
    'BRU': 'Brussels Airlines',
    'AEA': 'Air Europa',
    'RJA': 'Royal Jordanian',
    'DLA': 'Air Dolomiti',
    'STK': 'Stobart Air',
    'GCR': 'Tianjin Airlines',
    'SLI': 'Aeromexico Connect',
    'NOS': 'Neos',
    'HOP': 'Air France Hop',
    'GFA': 'Gulf Air',
    'CFE': 'BA CityFlyer',
    'CXA': 'Xiamen Airlines',
    'OMA': 'Oman Air',
    'NRS': 'Norwegian Air UK Ltd',
    'LAN': 'LATAM Airlines',
    'AMX': 'Aeromexico',
    'RBA': 'Royal Brunei',
    'EVA': 'EVA Air',
    'UPS': 'UPS Airlines',
    'CAL': 'China Airlines',
    'CSS': 'SF Airlines',
    'JNA': 'Jin Air',
    'NCT': 'NokScoot',
    'NWS': 'Nordwind Airlines',
    'BBC': 'Biman Bangladesh Airlines',
    'CKS': 'Kalitta Air',
    'FDX': 'FedEx Express',
    'KAR': 'Karair',
    'KTK': 'Azur Air',
    'PAC': 'Pacific Airlines',
    'OAE': 'Omni Air International',
    'ATN': 'Air Transport International',
    'CJT': 'Cargojet',
    'CFG': 'Condor Flugdienst GmbH',
    'AIZ': 'Arkia',
    'NAC': 'Northern Air Cargo',
    'LNE': 'Aerolane',
    'GTI': 'Atlas Air',
    'DHK': 'DHL Air Ltd',
    'ADO': 'Air Do',
    'ABX': 'ABX Air',
    'CRK': 'HONGKONG AIRLINES',
    'FWI': 'Air Caraibes',
    'IRM': 'Mahan Air',
    'EDW': 'Edelweiss Air',
    'THT': 'Air Tahiti Nui',
    'KMF': 'Kam Air',
    'ROI': 'Avior Airlines',
    'SLM': 'Surinam Airways',
    'SYR': 'Syrian Airlines',
    'XLF': 'XL Airways France',
    'FJI': 'Fiji Airways',
    'BEE': 'Flybe',
    'ANO': 'Airnorth',
    'TC1': 'Air Tanzania',
    'MDG': 'Air Madagascar',
    'AHK': 'Air Hong Kong',
    'TPA': 'Avianca Cargo',
    'ALK': 'SriLankan Airlines',
    'HKC': 'Hong Kong Air Cargo',
    'EXS': 'Jet2.com',
    'ESR': 'Eastar Jet',
    'TCV': 'Cabo Verde Airlines',
    'VOZ': 'Virgin Australia',
    'CRL': 'Corsair International',
    'SEJ': 'SpiceJet',
    'MAL': 'Morningstar Air Express',
    'BDA': 'Blue Dart Aviation',
    'TUA': 'OJSC Turkmenistan Airlines',
    'MXD': 'Batik Air Malaysia',
    'KNA': 'Kunming Airlines',
    'IBK': 'Norwegian Air International',
    'ARE': 'LATAM Airlines Colombia',
    'SGQ': 'SaudiGulf Airlines',
    'AD6': 'Azul Brazilian Airlines',
    'TFR': 'Toll Priority',
    'SID': 'Sideral',
    'NG1': 'Novair',
    'GHN': 'Air Ghana',
    'CDG': 'Shandong Airlines',
    'GLO': 'Gol Linhas Aéreas Inteligentes',
    'JLL': 'JetLite',
    'GLP': 'Globus Airlines',
    'FDB': 'flydubai',
    'CSH': 'Shanghai Airlines',
    'FBA': 'Fly Baghdad',
    'ENT': 'Enter Air',
    'WSW': 'Swoop',
    'PBD': 'Pobeda',
    'RLH': 'Ruili Airlines',
    'SJY': 'Sriwijaya Air',
    'SJY': 'Sriwijaya Air',








    # Add more mappings as required
})

# Function to extract airline name based on callsign with the updated dictionary
def get_airline_name_full(callsign):
    prefix = callsign[:3]
    airline_name = callsign_to_airline_full[prefix]

    if airline_name == 'Unknown':
        print(f"Unknown airline for prefix: {prefix}")

    return airline_name

# Apply the function to the 'callsign' column
data['airline_name'] = data['callsign'].apply(get_airline_name_full)

# Plot the frequency distribution of flights based on airline name
plt.figure(figsize=(12, 8))
data['airline_name'].value_counts().plot(kind='bar')
plt.title('Frequency Distribution of Flights Based on Airline Name')
plt.xlabel('Airline Name')
plt.ylabel('Number of Flights')
plt.xticks(rotation=45, ha='right')
plt.tight_layout()
plt.show()

# Extract the first three characters of the 'callsign' column
data['callsign_prefix'] = data['callsign'].apply(lambda x: x[:3])

# Write the dataframe to a new CSV file
output_file_path = 'Data/Callsign_Prefix.csv'
data.to_csv(output_file_path, index=False)
